{
  "stats": {
    "suites": 6,
    "tests": 37,
    "passes": 37,
    "pending": 0,
    "failures": 0,
    "start": "2025-10-19T13:10:41.041Z",
    "end": "2025-10-19T13:10:46.245Z",
    "duration": 5204,
    "testsRegistered": 37,
    "passPercent": 100,
    "pendingPercent": 0,
    "other": 0,
    "hasOther": false,
    "skipped": 0,
    "hasSkipped": false
  },
  "results": [
    {
      "uuid": "10cc7f02-8b38-4883-9c7e-d018c44f87e8",
      "title": "",
      "fullFile": "C:\\Users\\user\\OneDrive\\Desktop\\IPIT PROJECT\\PBS-BACKEND\\test\\post-api.test.js",
      "file": "\\post-api.test.js",
      "beforeHooks": [],
      "afterHooks": [],
      "tests": [],
      "suites": [
        {
          "uuid": "71ccd9df-ee39-4852-a6a4-004ede7a6342",
          "title": "POST API Tests",
          "fullFile": "C:\\Users\\user\\OneDrive\\Desktop\\IPIT PROJECT\\PBS-BACKEND\\test\\post-api.test.js",
          "file": "\\post-api.test.js",
          "beforeHooks": [
            {
              "title": "\"before all\" hook in \"POST API Tests\"",
              "fullTitle": "POST API Tests \"before all\" hook in \"POST API Tests\"",
              "timedOut": false,
              "duration": 710,
              "state": null,
              "speed": null,
              "pass": false,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "this.timeout(15000);\nconst db = await connectToMongo();\nconsole.log('Test database connected for POST tests');\n// Create a test user for order tests\nconst userResult = await db.collection('Users').insertOne({\n  name: 'Order Test User',\n  email: 'ordertest@example.com',\n  password: Buffer.from('password123').toString('base64'),\n  createdAt: new Date()\n});\ntestUserId = userResult.insertedId.toString();\n// Create a test product for cart and order tests\nconst productResult = await db.collection('Products').insertOne({\n  name: 'Test Product for Orders',\n  description: 'Test description',\n  price: 99.99,\n  category: 'Test',\n  imageUrl: '',\n  stock: 10,\n  createdAt: new Date()\n});\ntestProductId = productResult.insertedId.toString();",
              "err": {},
              "uuid": "208e0ce4-4145-4ce3-b63c-04ed652e403f",
              "parentUUID": "71ccd9df-ee39-4852-a6a4-004ede7a6342",
              "isHook": true,
              "skipped": false
            }
          ],
          "afterHooks": [
            {
              "title": "\"after all\" hook in \"POST API Tests\"",
              "fullTitle": "POST API Tests \"after all\" hook in \"POST API Tests\"",
              "timedOut": false,
              "duration": 529,
              "state": null,
              "speed": null,
              "pass": false,
              "fail": false,
              "pending": false,
              "context": null,
              "code": "const db = await connectToMongo();\n\n// Cleanup all created test data\nif (createdUserIds.length > 0) {\n  await db.collection('Users').deleteMany({\n    _id: { $in: createdUserIds.map(id => new ObjectId(id)) }\n  });\n}\n\nif (createdProductIds.length > 0) {\n  await db.collection('Products').deleteMany({\n    _id: { $in: createdProductIds.map(id => new ObjectId(id)) }\n  });\n}\nawait db.collection('Users').deleteOne({ _id: new ObjectId(testUserId) });\nawait db.collection('Products').deleteOne({ _id: new ObjectId(testProductId) });\nawait db.collection('Cart').deleteMany({ productId: testProductId });\nawait db.collection('Orders').deleteMany({ userId: testUserId });\n\nconsole.log('Test data cleaned up');",
              "err": {},
              "uuid": "6fce4cb4-adf5-4dca-b285-703cd61c8715",
              "parentUUID": "71ccd9df-ee39-4852-a6a4-004ede7a6342",
              "isHook": true,
              "skipped": false
            }
          ],
          "tests": [],
          "suites": [
            {
              "uuid": "cf71bf31-ae37-4eec-800e-4e2d8c9bb7d8",
              "title": "POST /signup",
              "fullFile": "C:\\Users\\user\\OneDrive\\Desktop\\IPIT PROJECT\\PBS-BACKEND\\test\\post-api.test.js",
              "file": "\\post-api.test.js",
              "beforeHooks": [],
              "afterHooks": [],
              "tests": [
                {
                  "title": "should register a new user successfully",
                  "fullTitle": "POST API Tests POST /signup should register a new user successfully",
                  "timedOut": false,
                  "duration": 193,
                  "state": "passed",
                  "speed": "slow",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const uniqueEmail = `testuser${Date.now()}@example.com`;\nconst res = await request(app)\n  .post('/signup')\n  .send({\n    name: 'Test User',\n    email: uniqueEmail,\n    password: 'securePass123',\n    confirmPassword: 'securePass123'\n  });\n\nexpect(res.status).to.equal(201);\nexpect(res.body).to.have.property('message', 'User created successfully');\nexpect(res.body).to.have.property('userId');\ncreatedUserIds.push(res.body.userId);",
                  "err": {},
                  "uuid": "4e1ca95b-2c1d-4a5a-bf74-afc3b2226891",
                  "parentUUID": "cf71bf31-ae37-4eec-800e-4e2d8c9bb7d8",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should reject signup without email",
                  "fullTitle": "POST API Tests POST /signup should reject signup without email",
                  "timedOut": false,
                  "duration": 7,
                  "state": "passed",
                  "speed": "fast",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/signup')\n  .send({\n    name: 'Test User',\n    password: 'securePass123',\n    confirmPassword: 'securePass123'\n  });\n\nexpect(res.status).to.equal(400);\nexpect(res.body).to.have.property('error', 'Email and password are required');",
                  "err": {},
                  "uuid": "d7e942e2-6c2c-402a-bf7d-547fdd5424e3",
                  "parentUUID": "cf71bf31-ae37-4eec-800e-4e2d8c9bb7d8",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should reject signup without password",
                  "fullTitle": "POST API Tests POST /signup should reject signup without password",
                  "timedOut": false,
                  "duration": 7,
                  "state": "passed",
                  "speed": "fast",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/signup')\n  .send({\n    name: 'Test User',\n    email: 'test@example.com',\n    confirmPassword: 'securePass123'\n  });\n\nexpect(res.status).to.equal(400);\nexpect(res.body).to.have.property('error', 'Email and password are required');",
                  "err": {},
                  "uuid": "eb38e03c-6b27-43e5-93d2-42d1d164ee19",
                  "parentUUID": "cf71bf31-ae37-4eec-800e-4e2d8c9bb7d8",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should reject signup with short password",
                  "fullTitle": "POST API Tests POST /signup should reject signup with short password",
                  "timedOut": false,
                  "duration": 11,
                  "state": "passed",
                  "speed": "fast",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/signup')\n  .send({\n    name: 'Test User',\n    email: 'test@example.com',\n    password: 'short',\n    confirmPassword: 'short'\n  });\n\nexpect(res.status).to.equal(400);\nexpect(res.body).to.have.property('error', 'Password must be at least 8 characters long');",
                  "err": {},
                  "uuid": "7798bc31-63d3-4212-b289-dfffa1d87b85",
                  "parentUUID": "cf71bf31-ae37-4eec-800e-4e2d8c9bb7d8",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should reject signup with mismatched passwords",
                  "fullTitle": "POST API Tests POST /signup should reject signup with mismatched passwords",
                  "timedOut": false,
                  "duration": 12,
                  "state": "passed",
                  "speed": "fast",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/signup')\n  .send({\n    name: 'Test User',\n    email: 'test@example.com',\n    password: 'securePass123',\n    confirmPassword: 'differentPass123'\n  });\n\nexpect(res.status).to.equal(400);\nexpect(res.body).to.have.property('error', 'Passwords do not match');",
                  "err": {},
                  "uuid": "ed691124-d165-4017-963d-fe5e0ebade0e",
                  "parentUUID": "cf71bf31-ae37-4eec-800e-4e2d8c9bb7d8",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should reject duplicate email registration",
                  "fullTitle": "POST API Tests POST /signup should reject duplicate email registration",
                  "timedOut": false,
                  "duration": 152,
                  "state": "passed",
                  "speed": "slow",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const uniqueEmail = `duplicate${Date.now()}@example.com`;\n\n// First registration\nconst res1 = await request(app)\n  .post('/signup')\n  .send({\n    name: 'Test User',\n    email: uniqueEmail,\n    password: 'securePass123',\n    confirmPassword: 'securePass123'\n  });\n\nexpect(res1.status).to.equal(201);\ncreatedUserIds.push(res1.body.userId);\n// Second registration with same email\nconst res2 = await request(app)\n  .post('/signup')\n  .send({\n    name: 'Test User 2',\n    email: uniqueEmail,\n    password: 'anotherPass123',\n    confirmPassword: 'anotherPass123'\n  });\n\nexpect(res2.status).to.equal(409);\nexpect(res2.body).to.have.property('error', 'Email already registered');",
                  "err": {},
                  "uuid": "0e455eea-5775-48a1-b8d8-92b5b80c5020",
                  "parentUUID": "cf71bf31-ae37-4eec-800e-4e2d8c9bb7d8",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should normalize email to lowercase",
                  "fullTitle": "POST API Tests POST /signup should normalize email to lowercase",
                  "timedOut": false,
                  "duration": 166,
                  "state": "passed",
                  "speed": "slow",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const uniqueEmail = `TestUser${Date.now()}@Example.COM`;\nconst res = await request(app)\n  .post('/signup')\n  .send({\n    name: 'Test User',\n    email: uniqueEmail,\n    password: 'securePass123',\n    confirmPassword: 'securePass123'\n  });\n\nexpect(res.status).to.equal(201);\ncreatedUserIds.push(res.body.userId);\n// Verify email was stored in lowercase\nconst db = await connectToMongo();\nconst user = await db.collection('Users').findOne({ _id: new ObjectId(res.body.userId) });\nexpect(user.email).to.equal(uniqueEmail.toLowerCase());",
                  "err": {},
                  "uuid": "7d80f957-2582-4741-b557-11f416193e5f",
                  "parentUUID": "cf71bf31-ae37-4eec-800e-4e2d8c9bb7d8",
                  "isHook": false,
                  "skipped": false
                }
              ],
              "suites": [],
              "passes": [
                "4e1ca95b-2c1d-4a5a-bf74-afc3b2226891",
                "d7e942e2-6c2c-402a-bf7d-547fdd5424e3",
                "eb38e03c-6b27-43e5-93d2-42d1d164ee19",
                "7798bc31-63d3-4212-b289-dfffa1d87b85",
                "ed691124-d165-4017-963d-fe5e0ebade0e",
                "0e455eea-5775-48a1-b8d8-92b5b80c5020",
                "7d80f957-2582-4741-b557-11f416193e5f"
              ],
              "failures": [],
              "pending": [],
              "skipped": [],
              "duration": 548,
              "root": false,
              "rootEmpty": false,
              "_timeout": 10000
            },
            {
              "uuid": "ac75a175-2279-4382-bb43-68ff56e73498",
              "title": "POST /signin",
              "fullFile": "C:\\Users\\user\\OneDrive\\Desktop\\IPIT PROJECT\\PBS-BACKEND\\test\\post-api.test.js",
              "file": "\\post-api.test.js",
              "beforeHooks": [
                {
                  "title": "\"before all\" hook in \"POST /signin\"",
                  "fullTitle": "POST API Tests POST /signin \"before all\" hook in \"POST /signin\"",
                  "timedOut": false,
                  "duration": 124,
                  "state": null,
                  "speed": null,
                  "pass": false,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "testEmail = `signintest${Date.now()}@example.com`;\ntestPassword = 'testPassword123';\n\nconst res = await request(app)\n  .post('/signup')\n  .send({\n    name: 'Signin Test User',\n    email: testEmail,\n    password: testPassword,\n    confirmPassword: testPassword\n  });\n\ncreatedUserIds.push(res.body.userId);",
                  "err": {},
                  "uuid": "10c3e9f1-e47b-4ab9-9d75-83a73d5ec835",
                  "parentUUID": "ac75a175-2279-4382-bb43-68ff56e73498",
                  "isHook": true,
                  "skipped": false
                }
              ],
              "afterHooks": [],
              "tests": [
                {
                  "title": "should login successfully with correct credentials",
                  "fullTitle": "POST API Tests POST /signin should login successfully with correct credentials",
                  "timedOut": false,
                  "duration": 58,
                  "state": "passed",
                  "speed": "medium",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/signin')\n  .send({\n    email: testEmail,\n    password: testPassword\n  });\n\nexpect(res.status).to.equal(200);\nexpect(res.body).to.have.property('message', 'Login successful');\nexpect(res.body).to.have.property('user');\nexpect(res.body.user).to.have.property('email', testEmail.toLowerCase());\nexpect(res.body.user).to.have.property('id');\nexpect(res.body.user).to.not.have.property('password');",
                  "err": {},
                  "uuid": "10ffbc92-ec43-4b61-9d1e-8e740d479b17",
                  "parentUUID": "ac75a175-2279-4382-bb43-68ff56e73498",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should reject signin without email",
                  "fullTitle": "POST API Tests POST /signin should reject signin without email",
                  "timedOut": false,
                  "duration": 5,
                  "state": "passed",
                  "speed": "fast",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/signin')\n  .send({\n    password: testPassword\n  });\n\nexpect(res.status).to.equal(400);\nexpect(res.body).to.have.property('error', 'Email and password are required');",
                  "err": {},
                  "uuid": "419dc48d-374a-41f2-ba7a-84eb4da2436c",
                  "parentUUID": "ac75a175-2279-4382-bb43-68ff56e73498",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should reject signin without password",
                  "fullTitle": "POST API Tests POST /signin should reject signin without password",
                  "timedOut": false,
                  "duration": 4,
                  "state": "passed",
                  "speed": "fast",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/signin')\n  .send({\n    email: testEmail\n  });\n\nexpect(res.status).to.equal(400);\nexpect(res.body).to.have.property('error', 'Email and password are required');",
                  "err": {},
                  "uuid": "66035831-693b-4965-84d7-5a3d1f598f78",
                  "parentUUID": "ac75a175-2279-4382-bb43-68ff56e73498",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should reject signin with incorrect password",
                  "fullTitle": "POST API Tests POST /signin should reject signin with incorrect password",
                  "timedOut": false,
                  "duration": 116,
                  "state": "passed",
                  "speed": "slow",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/signin')\n  .send({\n    email: testEmail,\n    password: 'wrongPassword'\n  });\n\nexpect(res.status).to.equal(401);\nexpect(res.body).to.have.property('error', 'Invalid email or password');",
                  "err": {},
                  "uuid": "1afd035a-e629-4c37-832e-a879d6dd87a0",
                  "parentUUID": "ac75a175-2279-4382-bb43-68ff56e73498",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should reject signin with non-existent email",
                  "fullTitle": "POST API Tests POST /signin should reject signin with non-existent email",
                  "timedOut": false,
                  "duration": 74,
                  "state": "passed",
                  "speed": "medium",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/signin')\n  .send({\n    email: 'nonexistent@example.com',\n    password: testPassword\n  });\n\nexpect(res.status).to.equal(401);\nexpect(res.body).to.have.property('error', 'Invalid email or password');",
                  "err": {},
                  "uuid": "73207129-8d7f-4c4b-b945-2e941668718b",
                  "parentUUID": "ac75a175-2279-4382-bb43-68ff56e73498",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should handle case-insensitive email login",
                  "fullTitle": "POST API Tests POST /signin should handle case-insensitive email login",
                  "timedOut": false,
                  "duration": 60,
                  "state": "passed",
                  "speed": "medium",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/signin')\n  .send({\n    email: testEmail.toUpperCase(),\n    password: testPassword\n  });\n\nexpect(res.status).to.equal(200);\nexpect(res.body.user.email).to.equal(testEmail.toLowerCase());",
                  "err": {},
                  "uuid": "eee9e10f-a7ca-414b-852d-703f5c12ca55",
                  "parentUUID": "ac75a175-2279-4382-bb43-68ff56e73498",
                  "isHook": false,
                  "skipped": false
                }
              ],
              "suites": [],
              "passes": [
                "10ffbc92-ec43-4b61-9d1e-8e740d479b17",
                "419dc48d-374a-41f2-ba7a-84eb4da2436c",
                "66035831-693b-4965-84d7-5a3d1f598f78",
                "1afd035a-e629-4c37-832e-a879d6dd87a0",
                "73207129-8d7f-4c4b-b945-2e941668718b",
                "eee9e10f-a7ca-414b-852d-703f5c12ca55"
              ],
              "failures": [],
              "pending": [],
              "skipped": [],
              "duration": 317,
              "root": false,
              "rootEmpty": false,
              "_timeout": 10000
            },
            {
              "uuid": "40c39c16-0144-46aa-8cd1-691c16d641d8",
              "title": "POST /products",
              "fullFile": "C:\\Users\\user\\OneDrive\\Desktop\\IPIT PROJECT\\PBS-BACKEND\\test\\post-api.test.js",
              "file": "\\post-api.test.js",
              "beforeHooks": [],
              "afterHooks": [],
              "tests": [
                {
                  "title": "should create a new product successfully",
                  "fullTitle": "POST API Tests POST /products should create a new product successfully",
                  "timedOut": false,
                  "duration": 100,
                  "state": "passed",
                  "speed": "slow",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/products')\n  .send({\n    name: 'New Test Product',\n    description: 'A great product',\n    price: 199.99,\n    category: 'Electronics',\n    imageUrl: 'http://example.com/product.jpg',\n    stock: 25\n  });\n\nexpect(res.status).to.equal(201);\nexpect(res.body).to.have.property('message', 'Product created');\nexpect(res.body).to.have.property('id');\ncreatedProductIds.push(res.body.id);",
                  "err": {},
                  "uuid": "8befe17d-1240-48d4-8e70-22c1c102f7f4",
                  "parentUUID": "40c39c16-0144-46aa-8cd1-691c16d641d8",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should create product with minimal required fields",
                  "fullTitle": "POST API Tests POST /products should create product with minimal required fields",
                  "timedOut": false,
                  "duration": 144,
                  "state": "passed",
                  "speed": "slow",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/products')\n  .send({\n    name: 'Minimal Product',\n    price: 49.99,\n    category: 'Test'\n  });\n\nexpect(res.status).to.equal(201);\nexpect(res.body).to.have.property('id');\ncreatedProductIds.push(res.body.id);\n// Verify defaults were applied\nconst db = await connectToMongo();\nconst product = await db.collection('Products').findOne({ _id: new ObjectId(res.body.id) });\nexpect(product.description).to.equal('');\nexpect(product.imageUrl).to.equal('');\nexpect(product.stock).to.equal(0);",
                  "err": {},
                  "uuid": "ba4d93ef-5740-4f54-b2ff-8476eed5bc3c",
                  "parentUUID": "40c39c16-0144-46aa-8cd1-691c16d641d8",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should reject product creation without name",
                  "fullTitle": "POST API Tests POST /products should reject product creation without name",
                  "timedOut": false,
                  "duration": 7,
                  "state": "passed",
                  "speed": "fast",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/products')\n  .send({\n    description: 'Test',\n    price: 99.99,\n    category: 'Test'\n  });\n\nexpect(res.status).to.equal(400);\nexpect(res.body).to.have.property('error', 'Name, price, and category are required');",
                  "err": {},
                  "uuid": "a9ccf354-4934-47be-b7a7-d16780fe7c0a",
                  "parentUUID": "40c39c16-0144-46aa-8cd1-691c16d641d8",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should reject product creation without price",
                  "fullTitle": "POST API Tests POST /products should reject product creation without price",
                  "timedOut": false,
                  "duration": 6,
                  "state": "passed",
                  "speed": "fast",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/products')\n  .send({\n    name: 'Test Product',\n    category: 'Test'\n  });\n\nexpect(res.status).to.equal(400);\nexpect(res.body).to.have.property('error', 'Name, price, and category are required');",
                  "err": {},
                  "uuid": "dbd800cb-f741-4ac5-9c71-e7e6c5ebd883",
                  "parentUUID": "40c39c16-0144-46aa-8cd1-691c16d641d8",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should reject product creation without category",
                  "fullTitle": "POST API Tests POST /products should reject product creation without category",
                  "timedOut": false,
                  "duration": 8,
                  "state": "passed",
                  "speed": "fast",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/products')\n  .send({\n    name: 'Test Product',\n    price: 99.99\n  });\n\nexpect(res.status).to.equal(400);\nexpect(res.body).to.have.property('error', 'Name, price, and category are required');",
                  "err": {},
                  "uuid": "a21f2040-b790-4758-b483-44e54cfd500a",
                  "parentUUID": "40c39c16-0144-46aa-8cd1-691c16d641d8",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should parse price as float",
                  "fullTitle": "POST API Tests POST /products should parse price as float",
                  "timedOut": false,
                  "duration": 96,
                  "state": "passed",
                  "speed": "slow",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/products')\n  .send({\n    name: 'Price Test Product',\n    price: '149.99',\n    category: 'Test'\n  });\n\nexpect(res.status).to.equal(201);\ncreatedProductIds.push(res.body.id);\nconst db = await connectToMongo();\nconst product = await db.collection('Products').findOne({ _id: new ObjectId(res.body.id) });\nexpect(product.price).to.be.a('number');\nexpect(product.price).to.equal(149.99);",
                  "err": {},
                  "uuid": "be928825-90fd-4b8c-91bf-0f64bb32e31a",
                  "parentUUID": "40c39c16-0144-46aa-8cd1-691c16d641d8",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should parse stock as integer",
                  "fullTitle": "POST API Tests POST /products should parse stock as integer",
                  "timedOut": false,
                  "duration": 107,
                  "state": "passed",
                  "speed": "slow",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/products')\n  .send({\n    name: 'Stock Test Product',\n    price: 49.99,\n    category: 'Test',\n    stock: '15'\n  });\n\nexpect(res.status).to.equal(201);\ncreatedProductIds.push(res.body.id);\nconst db = await connectToMongo();\nconst product = await db.collection('Products').findOne({ _id: new ObjectId(res.body.id) });\nexpect(product.stock).to.be.a('number');\nexpect(product.stock).to.equal(15);",
                  "err": {},
                  "uuid": "fd18d3fd-62a9-4999-976f-d5c5b313aaa6",
                  "parentUUID": "40c39c16-0144-46aa-8cd1-691c16d641d8",
                  "isHook": false,
                  "skipped": false
                }
              ],
              "suites": [],
              "passes": [
                "8befe17d-1240-48d4-8e70-22c1c102f7f4",
                "ba4d93ef-5740-4f54-b2ff-8476eed5bc3c",
                "a9ccf354-4934-47be-b7a7-d16780fe7c0a",
                "dbd800cb-f741-4ac5-9c71-e7e6c5ebd883",
                "a21f2040-b790-4758-b483-44e54cfd500a",
                "be928825-90fd-4b8c-91bf-0f64bb32e31a",
                "fd18d3fd-62a9-4999-976f-d5c5b313aaa6"
              ],
              "failures": [],
              "pending": [],
              "skipped": [],
              "duration": 468,
              "root": false,
              "rootEmpty": false,
              "_timeout": 10000
            },
            {
              "uuid": "381c64fc-673e-47b1-abad-1b8008abbbf8",
              "title": "POST /cart",
              "fullFile": "C:\\Users\\user\\OneDrive\\Desktop\\IPIT PROJECT\\PBS-BACKEND\\test\\post-api.test.js",
              "file": "\\post-api.test.js",
              "beforeHooks": [],
              "afterHooks": [
                {
                  "title": "\"after each\" hook in \"POST /cart\"",
                  "fullTitle": "POST API Tests POST /cart \"after each\" hook in \"POST /cart\"",
                  "timedOut": false,
                  "duration": 47,
                  "state": null,
                  "speed": null,
                  "pass": false,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const db = await connectToMongo();\nawait db.collection('Cart').deleteMany({ productId: testProductId });",
                  "err": {},
                  "uuid": "54c6618b-9a9c-4081-9c2c-8c2436bad9d8",
                  "parentUUID": "381c64fc-673e-47b1-abad-1b8008abbbf8",
                  "isHook": true,
                  "skipped": false
                }
              ],
              "tests": [
                {
                  "title": "should add item to cart successfully",
                  "fullTitle": "POST API Tests POST /cart should add item to cart successfully",
                  "timedOut": false,
                  "duration": 84,
                  "state": "passed",
                  "speed": "slow",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/cart')\n  .send({\n    productId: testProductId,\n    quantity: 3\n  });\n\nexpect(res.status).to.equal(201);\nexpect(res.body).to.have.property('message', 'Item added');\nexpect(res.body).to.have.property('id');",
                  "err": {},
                  "uuid": "0d94ca0d-db13-4d18-b00b-7da5dbc58cf0",
                  "parentUUID": "381c64fc-673e-47b1-abad-1b8008abbbf8",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should reject cart item without productId",
                  "fullTitle": "POST API Tests POST /cart should reject cart item without productId",
                  "timedOut": false,
                  "duration": 6,
                  "state": "passed",
                  "speed": "fast",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/cart')\n  .send({\n    quantity: 2\n  });\n\nexpect(res.status).to.equal(400);\nexpect(res.body).to.have.property('error', 'Missing productId or quantity');",
                  "err": {},
                  "uuid": "a31a68d1-8656-4682-95ce-642bfc6b0468",
                  "parentUUID": "381c64fc-673e-47b1-abad-1b8008abbbf8",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should reject cart item without quantity",
                  "fullTitle": "POST API Tests POST /cart should reject cart item without quantity",
                  "timedOut": false,
                  "duration": 5,
                  "state": "passed",
                  "speed": "fast",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/cart')\n  .send({\n    productId: testProductId\n  });\n\nexpect(res.status).to.equal(400);\nexpect(res.body).to.have.property('error', 'Missing productId or quantity');",
                  "err": {},
                  "uuid": "52a39e2f-69f0-45a4-9a15-82a309601b38",
                  "parentUUID": "381c64fc-673e-47b1-abad-1b8008abbbf8",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should accept additional cart item fields",
                  "fullTitle": "POST API Tests POST /cart should accept additional cart item fields",
                  "timedOut": false,
                  "duration": 116,
                  "state": "passed",
                  "speed": "slow",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/cart')\n  .send({\n    productId: testProductId,\n    quantity: 2,\n    userId: testUserId,\n    addedAt: new Date()\n  });\n\nexpect(res.status).to.equal(201);\n\nconst db = await connectToMongo();\nconst cartItem = await db.collection('Cart').findOne({ _id: new ObjectId(res.body.id) });\nexpect(cartItem.userId).to.equal(testUserId);",
                  "err": {},
                  "uuid": "8a783ccb-bf96-41cc-9dd0-38ef0bcf2fad",
                  "parentUUID": "381c64fc-673e-47b1-abad-1b8008abbbf8",
                  "isHook": false,
                  "skipped": false
                }
              ],
              "suites": [],
              "passes": [
                "0d94ca0d-db13-4d18-b00b-7da5dbc58cf0",
                "a31a68d1-8656-4682-95ce-642bfc6b0468",
                "52a39e2f-69f0-45a4-9a15-82a309601b38",
                "8a783ccb-bf96-41cc-9dd0-38ef0bcf2fad"
              ],
              "failures": [],
              "pending": [],
              "skipped": [],
              "duration": 211,
              "root": false,
              "rootEmpty": false,
              "_timeout": 10000
            },
            {
              "uuid": "55070f2c-83aa-4053-b8e0-4230852c2b50",
              "title": "POST /orders",
              "fullFile": "C:\\Users\\user\\OneDrive\\Desktop\\IPIT PROJECT\\PBS-BACKEND\\test\\post-api.test.js",
              "file": "\\post-api.test.js",
              "beforeHooks": [],
              "afterHooks": [
                {
                  "title": "\"after each\" hook in \"POST /orders\"",
                  "fullTitle": "POST API Tests POST /orders \"after each\" hook in \"POST /orders\"",
                  "timedOut": false,
                  "duration": 92,
                  "state": null,
                  "speed": null,
                  "pass": false,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const db = await connectToMongo();\nawait db.collection('Orders').deleteMany({ userId: testUserId });",
                  "err": {},
                  "uuid": "8a8e892c-d406-40f6-8a24-182fe95d0812",
                  "parentUUID": "55070f2c-83aa-4053-b8e0-4230852c2b50",
                  "isHook": true,
                  "skipped": false
                }
              ],
              "tests": [
                {
                  "title": "should create an order successfully",
                  "fullTitle": "POST API Tests POST /orders should create an order successfully",
                  "timedOut": false,
                  "duration": 122,
                  "state": "passed",
                  "speed": "slow",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/orders')\n  .send({\n    userId: testUserId,\n    items: [\n      { productId: testProductId, quantity: 2 }\n    ],\n    totalAmount: 199.98,\n    paymentMethod: 'card',\n    deliveryData: {\n      address: '123 Test Street',\n      city: 'Test City',\n      zipCode: '12345'\n    }\n  });\n\nexpect(res.status).to.equal(201);\nexpect(res.body).to.have.property('message', 'Order created');\nexpect(res.body).to.have.property('id');\n// Verify order in database\nconst db = await connectToMongo();\nconst order = await db.collection('Orders').findOne({ _id: new ObjectId(res.body.id) });\nexpect(order).to.exist;\nexpect(order.userId).to.equal(testUserId);\nexpect(order.totalAmount).to.equal(199.98);\nexpect(order.status).to.equal('pending');",
                  "err": {},
                  "uuid": "5cf85007-2c1e-479b-aa17-676325150a34",
                  "parentUUID": "55070f2c-83aa-4053-b8e0-4230852c2b50",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should create order with default status",
                  "fullTitle": "POST API Tests POST /orders should create order with default status",
                  "timedOut": false,
                  "duration": 133,
                  "state": "passed",
                  "speed": "slow",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/orders')\n  .send({\n    userId: testUserId,\n    items: [{ productId: testProductId, quantity: 1 }],\n    totalAmount: 99.99\n  });\n\nexpect(res.status).to.equal(201);\nconst db = await connectToMongo();\nconst order = await db.collection('Orders').findOne({ _id: new ObjectId(res.body.id) });\nexpect(order.status).to.equal('pending');",
                  "err": {},
                  "uuid": "21601b8c-350b-4f82-9e68-9e72278cb227",
                  "parentUUID": "55070f2c-83aa-4053-b8e0-4230852c2b50",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should reject order without userId",
                  "fullTitle": "POST API Tests POST /orders should reject order without userId",
                  "timedOut": false,
                  "duration": 6,
                  "state": "passed",
                  "speed": "fast",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/orders')\n  .send({\n    items: [{ productId: testProductId, quantity: 1 }],\n    totalAmount: 99.99\n  });\n\nexpect(res.status).to.equal(400);\nexpect(res.body).to.have.property('error', 'Invalid order data');",
                  "err": {},
                  "uuid": "91ad553e-2ae7-485c-8e42-e4b83be5cb55",
                  "parentUUID": "55070f2c-83aa-4053-b8e0-4230852c2b50",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should reject order without items",
                  "fullTitle": "POST API Tests POST /orders should reject order without items",
                  "timedOut": false,
                  "duration": 6,
                  "state": "passed",
                  "speed": "fast",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/orders')\n  .send({\n    userId: testUserId,\n    totalAmount: 99.99\n  });\n\nexpect(res.status).to.equal(400);\nexpect(res.body).to.have.property('error', 'Invalid order data');",
                  "err": {},
                  "uuid": "8cd66574-f55d-4eb1-9084-062b5672a0d2",
                  "parentUUID": "55070f2c-83aa-4053-b8e0-4230852c2b50",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should reject order with empty items array",
                  "fullTitle": "POST API Tests POST /orders should reject order with empty items array",
                  "timedOut": false,
                  "duration": 7,
                  "state": "passed",
                  "speed": "fast",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/orders')\n  .send({\n    userId: testUserId,\n    items: [],\n    totalAmount: 99.99\n  });\n\nexpect(res.status).to.equal(400);\nexpect(res.body).to.have.property('error', 'Invalid order data');",
                  "err": {},
                  "uuid": "ebf599d0-37b5-4a0d-b794-9badc1c53dfc",
                  "parentUUID": "55070f2c-83aa-4053-b8e0-4230852c2b50",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should reject order with non-array items",
                  "fullTitle": "POST API Tests POST /orders should reject order with non-array items",
                  "timedOut": false,
                  "duration": 6,
                  "state": "passed",
                  "speed": "fast",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/orders')\n  .send({\n    userId: testUserId,\n    items: 'not-an-array',\n    totalAmount: 99.99\n  });\n\nexpect(res.status).to.equal(400);\nexpect(res.body).to.have.property('error', 'Invalid order data');",
                  "err": {},
                  "uuid": "de06498e-4bb8-4d7d-b5fb-b642c10cf57d",
                  "parentUUID": "55070f2c-83aa-4053-b8e0-4230852c2b50",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should parse totalAmount as float",
                  "fullTitle": "POST API Tests POST /orders should parse totalAmount as float",
                  "timedOut": false,
                  "duration": 116,
                  "state": "passed",
                  "speed": "slow",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/orders')\n  .send({\n    userId: testUserId,\n    items: [{ productId: testProductId, quantity: 1 }],\n    totalAmount: '149.99'\n  });\n\nexpect(res.status).to.equal(201);\nconst db = await connectToMongo();\nconst order = await db.collection('Orders').findOne({ _id: new ObjectId(res.body.id) });\nexpect(order.totalAmount).to.be.a('number');\nexpect(order.totalAmount).to.equal(149.99);",
                  "err": {},
                  "uuid": "0e84fade-f6b5-4023-b13a-173614d70104",
                  "parentUUID": "55070f2c-83aa-4053-b8e0-4230852c2b50",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should create order with custom status",
                  "fullTitle": "POST API Tests POST /orders should create order with custom status",
                  "timedOut": false,
                  "duration": 94,
                  "state": "passed",
                  "speed": "slow",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/orders')\n  .send({\n    userId: testUserId,\n    items: [{ productId: testProductId, quantity: 1 }],\n    totalAmount: 99.99,\n    status: 'processing'\n  });\n\nexpect(res.status).to.equal(201);\nconst db = await connectToMongo();\nconst order = await db.collection('Orders').findOne({ _id: new ObjectId(res.body.id) });\nexpect(order.status).to.equal('processing');",
                  "err": {},
                  "uuid": "a0a6bbcc-5433-4317-8365-adc7ad83e8f9",
                  "parentUUID": "55070f2c-83aa-4053-b8e0-4230852c2b50",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should store deliveryData object",
                  "fullTitle": "POST API Tests POST /orders should store deliveryData object",
                  "timedOut": false,
                  "duration": 162,
                  "state": "passed",
                  "speed": "slow",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const deliveryData = {\n  address: '456 Main St',\n  city: 'Springfield',\n  state: 'IL',\n  zipCode: '62701',\n  phone: '555-1234'\n};\nconst res = await request(app)\n  .post('/orders')\n  .send({\n    userId: testUserId,\n    items: [{ productId: testProductId, quantity: 1 }],\n    totalAmount: 99.99,\n    deliveryData\n  });\n\nexpect(res.status).to.equal(201);\nconst db = await connectToMongo();\nconst order = await db.collection('Orders').findOne({ _id: new ObjectId(res.body.id) });\nexpect(order.deliveryData).to.deep.equal(deliveryData);",
                  "err": {},
                  "uuid": "2351e81e-1e63-482c-84ec-e300e6ecc7a6",
                  "parentUUID": "55070f2c-83aa-4053-b8e0-4230852c2b50",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should handle multiple items in order",
                  "fullTitle": "POST API Tests POST /orders should handle multiple items in order",
                  "timedOut": false,
                  "duration": 104,
                  "state": "passed",
                  "speed": "slow",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const items = [\n  { productId: testProductId, quantity: 2 },\n  { productId: new ObjectId().toString(), quantity: 1 },\n  { productId: new ObjectId().toString(), quantity: 3 }\n];\nconst res = await request(app)\n  .post('/orders')\n  .send({\n    userId: testUserId,\n    items,\n    totalAmount: 399.97\n  });\n\nexpect(res.status).to.equal(201);\nconst db = await connectToMongo();\nconst order = await db.collection('Orders').findOne({ _id: new ObjectId(res.body.id) });\nexpect(order.items).to.have.length(3);\nexpect(order.items).to.deep.equal(items);",
                  "err": {},
                  "uuid": "f7d39aa2-57b6-4eae-8568-382bfbe4d4e1",
                  "parentUUID": "55070f2c-83aa-4053-b8e0-4230852c2b50",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should set createdAt and updatedAt timestamps",
                  "fullTitle": "POST API Tests POST /orders should set createdAt and updatedAt timestamps",
                  "timedOut": false,
                  "duration": 113,
                  "state": "passed",
                  "speed": "slow",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const beforeTime = new Date();\n\nconst res = await request(app)\n  .post('/orders')\n  .send({\n    userId: testUserId,\n    items: [{ productId: testProductId, quantity: 1 }],\n    totalAmount: 99.99\n  });\n\nconst afterTime = new Date();\nexpect(res.status).to.equal(201);\nconst db = await connectToMongo();\nconst order = await db.collection('Orders').findOne({ _id: new ObjectId(res.body.id) });\n\nexpect(order.createdAt).to.be.instanceOf(Date);\nexpect(order.updatedAt).to.be.instanceOf(Date);\nexpect(order.createdAt.getTime()).to.be.at.least(beforeTime.getTime());\nexpect(order.createdAt.getTime()).to.be.at.most(afterTime.getTime());",
                  "err": {},
                  "uuid": "c6368695-c91d-4e25-a302-d6bcb1960d91",
                  "parentUUID": "55070f2c-83aa-4053-b8e0-4230852c2b50",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should default deliveryData to empty object if not provided",
                  "fullTitle": "POST API Tests POST /orders should default deliveryData to empty object if not provided",
                  "timedOut": false,
                  "duration": 212,
                  "state": "passed",
                  "speed": "slow",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/orders')\n  .send({\n    userId: testUserId,\n    items: [{ productId: testProductId, quantity: 1 }],\n    totalAmount: 99.99\n  });\n\nexpect(res.status).to.equal(201);\nconst db = await connectToMongo();\nconst order = await db.collection('Orders').findOne({ _id: new ObjectId(res.body.id) });\nexpect(order.deliveryData).to.deep.equal({});",
                  "err": {},
                  "uuid": "ecf18684-7e5b-4e9a-981a-c3cd30f157eb",
                  "parentUUID": "55070f2c-83aa-4053-b8e0-4230852c2b50",
                  "isHook": false,
                  "skipped": false
                },
                {
                  "title": "should default paymentMethod to \"pending\" if not provided",
                  "fullTitle": "POST API Tests POST /orders should default paymentMethod to \"pending\" if not provided",
                  "timedOut": false,
                  "duration": 151,
                  "state": "passed",
                  "speed": "slow",
                  "pass": true,
                  "fail": false,
                  "pending": false,
                  "context": null,
                  "code": "const res = await request(app)\n  .post('/orders')\n  .send({\n    userId: testUserId,\n    items: [{ productId: testProductId, quantity: 1 }],\n    totalAmount: 99.99\n  });\n\nexpect(res.status).to.equal(201);\nconst db = await connectToMongo();\nconst order = await db.collection('Orders').findOne({ _id: new ObjectId(res.body.id) });\nexpect(order.paymentMethod).to.equal('pending');",
                  "err": {},
                  "uuid": "a1fcc547-3e02-44b4-93d7-773afbd9d160",
                  "parentUUID": "55070f2c-83aa-4053-b8e0-4230852c2b50",
                  "isHook": false,
                  "skipped": false
                }
              ],
              "suites": [],
              "passes": [
                "5cf85007-2c1e-479b-aa17-676325150a34",
                "21601b8c-350b-4f82-9e68-9e72278cb227",
                "91ad553e-2ae7-485c-8e42-e4b83be5cb55",
                "8cd66574-f55d-4eb1-9084-062b5672a0d2",
                "ebf599d0-37b5-4a0d-b794-9badc1c53dfc",
                "de06498e-4bb8-4d7d-b5fb-b642c10cf57d",
                "0e84fade-f6b5-4023-b13a-173614d70104",
                "a0a6bbcc-5433-4317-8365-adc7ad83e8f9",
                "2351e81e-1e63-482c-84ec-e300e6ecc7a6",
                "f7d39aa2-57b6-4eae-8568-382bfbe4d4e1",
                "c6368695-c91d-4e25-a302-d6bcb1960d91",
                "ecf18684-7e5b-4e9a-981a-c3cd30f157eb",
                "a1fcc547-3e02-44b4-93d7-773afbd9d160"
              ],
              "failures": [],
              "pending": [],
              "skipped": [],
              "duration": 1232,
              "root": false,
              "rootEmpty": false,
              "_timeout": 10000
            }
          ],
          "passes": [],
          "failures": [],
          "pending": [],
          "skipped": [],
          "duration": 0,
          "root": false,
          "rootEmpty": false,
          "_timeout": 10000
        }
      ],
      "passes": [],
      "failures": [],
      "pending": [],
      "skipped": [],
      "duration": 0,
      "root": true,
      "rootEmpty": true,
      "_timeout": 10000
    }
  ],
  "meta": {
    "mocha": {
      "version": "11.7.4"
    },
    "mochawesome": {
      "options": {
        "quiet": false,
        "reportFilename": "mochawesome",
        "saveHtml": true,
        "saveJson": true,
        "consoleReporter": "spec",
        "useInlineDiffs": false,
        "code": true
      },
      "version": "7.1.4"
    },
    "marge": {
      "options": null,
      "version": "6.3.0"
    }
  }
}